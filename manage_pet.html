<!doctype html>
<html lang="en">
<!-- Mirrored from themeslay.com/preview/items/HTML-Websites/TravelAgency/ver3.0/dashboard.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 17 Oct 2024 17:09:12 GMT -->
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="ThemesLay">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="16x16" href="assets/images/favicon.png">

    <!-- Bootstrap CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Main CSS -->
    <link href="assets/css/main.css" rel="stylesheet">

    <!-- Inner page CSS -->
    <link href="assets/css/inner.css" rel="stylesheet">

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- SweetAlert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- Ionicons (Using ES Module for better performance) -->
    <script type="module" src="https://unpkg.com/ionicons@4.5.10-0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@4.5.10-0/dist/ionicons/ionicons.js"></script>

    <!-- Main JS -->
    <script src="assets/js/main.js"></script>
    <!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- jQuery (ensure this is included before Bootstrap JS) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>


    <!-- Page Title -->
    <title>Dashboard</title>
</head>
<style>
    a{
        text-decoration-line: none;
    }
</style>
 
<body>
     
    <!-- modal box for Logout Profile-->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="p-5 text-center">
                    <h3 class="fs-2 fw-bold">Are you sure?
                        <br>
                        you want to log out.
                    </h3>
                    <p class="font-medium">You have successfully logged out.</p>
                    <a data-bs-dismiss="modal" class="btn btn-view min-h-auto">
                        <span class="fw-bold">Yes Confirm</span>
                    </a>
                    <a data-bs-dismiss="modal" class="btn border theme-border-radius effect ms-3">No Cancel
                        <i class="bi bi-arrow-right ms-2"></i></a>
                </div>
            </div>
        </div>
    </div>
    <!-- page content area -->
    <div class="pagewrap">
         
        
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="breadcrumb-content" style="display: flex; justify-content: space-around;" >
                        <h2>Admin Dashboard</h2>
                        <h4><a style="color: black;" href="index.html"><ion-icon size="large" name="home"></ion-icon></a></h4>     
                    </div>
                </div>
            </div>
        </div>
        <!-- body section -->
        <div class="content-section">
            <!-- dashboard section -->
            <div class="py-5">
                <div class="container">
                    <div class="row">
                        <!-- dashboard nav section -->
                        <div class="col-12 col-md-3">
                            <div class="d-flex flex-column theme-border-radius theme-bg-white theme-box-shadow">
                                <div class="d-flex flex-column p-3">
                                    <span class="text-center mb-3 profile-pic">
                                        <img src="assets/images/icons/profile-icon.png" alt="Profile Pic"
                                            title="Profile Pic">
                                        <a href="#" class="edit-btn"><i class="bi bi-pencil p-3"></i></a>
                                    </span>
                                    <span class="font-medium text-center">Kislay Chhimwal</span>
                                    <span class="font-small text-center">Personal Profile</span>
                                </div>
                                <ul id="dashboard">
                                    <li>
                                        <a href="dashboard.html"  class=" border-bottom p-3 theme-text-accent-one"><i
                                                class="bi bi-speedometer fs-4 me-2 align-middle"></i>Dashboard</a>
                                    </li>
                                    <li>
                                        <a href="manage_shelter.html" class="border-bottom p-3 theme-text-accent-one"><i
                                                class="bi bi-speedometer fs-4 me-2 align-middle"></i>Manage Shelter</a>
                                    </li>
                                    <li><a href="manage_donation.html" class="border-bottom p-3 theme-text-accent-one"><i
                                                class="bi bi-card-list fs-4 me-2 align-middle"></i>Manage the Donation</a>
                                    </li>
                                    <li><a href="manage_pet.html" class="border-bottom p-3 theme-text-accent-one"><i
                                        class="bi bi-card-list fs-4 me-2 align-middle"></i>Manage the Pet</a>
                                     </li>
                                     
                                    <li><a href="notification.html" class="border-bottom p-3 theme-text-accent-one"><i
                                                class="bi bi-bell fs-4 me-2 align-middle"></i>Notification</a>
                                    </li>
                                    <li>
                                        <a href="#" class="border-bottom p-3 theme-text-accent-one logout-btn">
                                          <i class="bi bi-box-arrow-right fs-4 me-2 align-middle"></i>Logout
                                        </a>
                                      </li>
                                      

                                </ul>

                            </div>
                        </div>
                        <!-- dashboard content section -->
                        <div class="col-12 col-md-9">
                            <div class="d-flex align-self-center justify-content-center align-items-center mb-5">
                                <!-- <h3 class="display-6 mb-0">Welcome to <span class="high-text">Dashboard</span></h3> -->
                            </div>
                            
                            
                            <!-- recent booking section -->
                            <div class="d-flex flex-column theme-border-radius theme-bg-white theme-box-shadow">
                                <!-- my wallet section -->
                                <div class="d-flex justify-content-between p-3 wallet-head">
                                    <span class="text-uppercase fw-bold">Manage PET</span>
                                    
                                </div>
                                <!-- my booking section -->
                                <div class="p-3">
                                    <div class="tble_wrap">
                                      <div class="table-responsive">
                                        <!-- booking table -->
                                        <table class="table table-striped>
                                          <thead>
                                            <tr>
                                              <th style="color: black; display: none;">Donation ID</th>
                                              <th style="color: black;">Donor Name</th>
                                              <th style="color: black;">Amount</th>
                                              <th style="color: black;">Date</th>
                                              <th style="color: black;">Action</th>
                                            </tr>
                                          </thead>
                                          <tbody id="donationTableBody">
                                            <!-- Rows will be dynamically added here -->
                                          </tbody>
                                        </table>
                                      </div>
                                    </div>
                                    <!-- pagination -->
                                    <div class="row">
                                      <div class="col-12 mt-3">
                                        <nav aria-label="Page navigation example">
                                          <ul class="pagination justify-content-center" id="pagination">
                                            <!-- Pagination items will be appended dynamically -->
                                          </ul>
                                        </nav>
                                      </div>
                                    </div>
                                  </div>
                                  
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
       

    </div>


<!-- Edit Pet Modal -->
<!-- <div class="modal fade" id="editPetModal" tabindex="-1" aria-labelledby="editPetModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editPetModalLabel">Edit Pet</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="editPetForm">
                    <div class="mb-3">
                        <label for="editShelterName" class="form-label">Shelter Name</label>
                        <input type="text" class="form-control" id="editShelterName" disabled>
                    </div>
                    <div class="mb-3">
                        <label for="editDescription" class="form-label">Description</label>
                        <input type="text" class="form-control" id="editDescription">
                    </div>
                    <div class="mb-3">
                        <label for="editStatus" class="form-label">Status</label>
                        <input type="number" class="form-control" id="editStatus">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="savePetChanges">Save Changes</button>
            </div>
        </div>
    </div>
</div> -->


<div class="modal" id="editPetModal" tabindex="-1" aria-labelledby="editPetModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editPetModalLabel">Edit Pet</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- ShelterId input (hidden or readonly) -->
                <input type="hidden" id="editShelterId" />
                
                <div class="mb-3">
                    <label for="editShelterName" class="form-label">Shelter Name</label>
                    <input type="text" class="form-control" id="editShelterName" />
                </div>
                
                <div class="mb-3">
                    <label for="editDescription" class="form-label">Description</label>
                    <textarea class="form-control" id="editDescription" rows="3"></textarea>
                </div>

                <div class="mb-3">
                    <label for="editStatus" class="form-label">Status</label>
                    <select class="form-control" id="editStatus">
                        <option value="1">Active</option>
                        <option value="0">Inactive</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" id="savePetChanges" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>





                    <!-- GET ALL PET va PAGING-->
<!-- <script>
    $(document).ready(function () {
    // AJAX GET request to fetch pet data
    $.ajax({
        url: "https://localhost:7063/api/Pet",
        method: "GET",
        dataType: "json",
        success: function (response) {
            const pets = response; // Assuming response is an array of pets
            const tableBody = $("#petTableBody");

            // Clear the table body
            tableBody.empty();

            // Iterate through pets and append rows
            pets.forEach((pet) => {
                const row = `
                    <tr>
                        <td style="display: none;">${pet.petId}</td>
                        <td>${pet.shelterName}</td>
                        <td>${pet.name}</td>
                        <td>${pet.description}</td>
                        <td>${pet.species}</td>
                        <td>
                           <button class="edit-pet-btn btn btn-outline-primary">Edit</button>
        <button class="delete-pet-btn btn btn-outline-danger">Disable</button>
                        </td>
                    </tr>
                `;
                tableBody.append(row);
            });
        },
        error: function (error) {
            console.error("Error fetching pet data:", error);
        },
    });
});

</script> -->

<script>
    $(document).ready(function () {
  const itemsPerPage = 3; // Số donation trên mỗi trang
  let currentPage = 1;
  let totalPages = 1;
  let donations = []; // Danh sách donation

  // Hàm hiển thị bảng
  function renderTable(page) {
    const start = (page - 1) * itemsPerPage;
    const end = start + itemsPerPage;
    const paginatedDonations = donations.slice(start, end);
    const tableBody = $("#donationTableBody");

    // Xóa dữ liệu cũ
    tableBody.empty();

    // Tạo hàng mới
    paginatedDonations.forEach((donation) => {
      const donationDate = new Date(donation.donationDate).toLocaleDateString(); // Định dạng ngày
      const row = `
        <tr>
          <td style="display: none;">${donation.donationId}</td>
          <td>${donation.fullName}</td>
          <td>${donation.amount.toLocaleString()} VND</td>
          <td>${donationDate}</td>
          <td>
            <a href="#">Edit</a> |
            <a style="color: red;" href="#">Disable</a>
          </td>
        </tr>
      `;
      tableBody.append(row);
    });

    updatePagination(page);
  }

  // Hàm cập nhật phân trang
  function updatePagination(page) {
    const pagination = $("#pagination");
    pagination.empty();

    // Nút trang trước
    const prevDisabled = page === 1 ? "disabled" : "";
    pagination.append(`
      <li class="page-item ${prevDisabled}">
        <a class="page-link" href="#" data-page="${page - 1}">
          <i class="fa fa-arrow-left"> ◀  </i>
        </a>
      </li>
    `);

    // Các nút số trang
    for (let i = 1; i <= totalPages; i++) {
      const active = i === page ? "active" : "";
      pagination.append(`
        <li class="page-item ${active}">
          <a class="page-link" href="#" data-page="${i}">${i}</a>
        </li>
      `);
    }

    // Nút trang sau
    const nextDisabled = page === totalPages ? "disabled" : "";
    pagination.append(`
      <li class="page-item ${nextDisabled}">
        <a class="page-link" href="#" data-page="${page + 1}">
          <i class="bi bi-arrow-right"> ▶ </i>
        </a>
      </li>
    `);

    // Thêm sự kiện click cho nút phân trang
    $(".page-link").on("click", function (e) {
      e.preventDefault();
      const newPage = parseInt($(this).data("page"));
      if (!isNaN(newPage)) {
        currentPage = newPage;
        renderTable(currentPage);
      }
    });
  }

  // Hàm khởi tạo bảng
  function initializeTable(responseData) {
    donations = responseData;
    totalPages = Math.ceil(donations.length / itemsPerPage);
    renderTable(currentPage);
  }

  // Fetch dữ liệu donation
  function fetchDonations() {
    $.ajax({
      url: "https://localhost:7063/api/Donation",
      method: "GET",
      dataType: "json",
      success: function (response) {
        initializeTable(response); // Giả định response là mảng donation
      },
      error: function (error) {
        console.error("Error fetching donation data:", error);
      },
    });
  }

  // Gọi hàm fetchDonations khi tài liệu đã sẵn sàng
  fetchDonations();
});

</script>
            <!-- edit pet  -->


       <!-- ko oke  -->
<!-- <script>
    $(document).ready(function () {
    let selectedPetId = ""; // To store the current petId for editing

    // Add click event listener to dynamically created Edit buttons
    $(document).on("click", ".edit-pet-btn", function () {
        // Get pet data from the row
        const petRow = $(this).closest("tr");
        const petId = petRow.find("td").eq(0).text(); // petId
        const shelterName = petRow.find("td").eq(1).text(); // shelterName
        const description = petRow.find("td").eq(3).text(); // description
        const status = 1; // Default status

        // Populate modal fields
        selectedPetId = petId;
        $("#editShelterName").val(shelterName);
        $("#editDescription").val(description);
        $("#editStatus").val(status);

        // Show the modal
        $("#editPetModal").modal("show");
    });

    // Save changes on button click
    $("#savePetChanges").click(function () {
        const updatedPet = {
            shelterId: selectedPetId,
            description: $("#editDescription").val(),
            status: parseInt($("#editStatus").val()),
        };

        // AJAX PUT request
        $.ajax({
            url: `https://localhost:7063/api/Pet?petId=${selectedPetId}`,
            method: "PUT",
            contentType: "application/json",
            data: JSON.stringify(updatedPet),
            success: function (response) {
                alert("Pet updated successfully!");
                $("#editPetModal").modal("hide");

                // Update the row in the table
                const petRow = $(`td:contains(${selectedPetId})`).closest("tr");
                petRow.find("td").eq(3).text(updatedPet.description);
                petRow.find("td").eq(4).text(updatedPet.status === 1 ? "Active" : "Inactive");
            },
            error: function (error) {
                console.error("Error updating pet:", error);
                alert("Failed to update pet. Please try again.");
            },
        });
    });
});

</script> -->
  
<!-- tam ok -->

<!-- <script>
    $(document).ready(function () {
        let selectedPetId = ""; // To store the current petId for editing

        // Add click event listener to dynamically created Edit buttons
        $(document).on("click", ".edit-pet-btn", function () {
            // Get pet data from the row
            const petRow = $(this).closest("tr");
            const petId = petRow.find("td").eq(0).text().trim(); // petId (first column)
            const shelterName = petRow.find("td").eq(1).text().trim(); // shelterName (second column)
            const description = petRow.find("td").eq(3).text().trim(); // description (fourth column)
            const status = petRow.find("td").eq(4).text().trim() === "Active" ? 1 : 0; // Status (fifth column)

            // Populate modal fields
            selectedPetId = petId; // Save the selected petId for the PUT request
            $("#editShelterName").val(shelterName);
            $("#editDescription").val(description);
            $("#editStatus").val(status);

            // Show the modal
            $("#editPetModal").modal("show");
        });

        // Save changes on button click
        $("#savePetChanges").click(function () {
            const updatedPet = {
                petId: selectedPetId,
                shelterName: $("#editShelterName").val(),
                description: $("#editDescription").val(),
                status: parseInt($("#editStatus").val()),
            };

            // AJAX PUT request to update pet details
            $.ajax({
                url: `https://localhost:7063/api/Pet?petId=${selectedPetId}`, // Include petId in the query string
                method: "PUT",
                contentType: "application/json",
                data: JSON.stringify(updatedPet), // Send the updated pet details as JSON
                success: function (response) {
                    alert("Pet updated successfully!");
                    $("#editPetModal").modal("hide");

                    // Update the corresponding row in the table
                    const petRow = $(`td:contains(${selectedPetId})`).closest("tr");
                    petRow.find("td").eq(1).text(updatedPet.shelterName); // Update shelterName column
                    petRow.find("td").eq(3).text(updatedPet.description); // Update description column
                    petRow.find("td").eq(4).text(updatedPet.status === 1 ? "Active" : "Inactive"); // Update status column
                },
                error: function (error) {
                    console.error("Error updating pet:", error);
                    alert("Failed to update pet. Please try again.");
                },
            });
        });
    });
</script> -->

        <!--edit test -->
        <script>
            $(document).ready(function () {
                let selectedPetId = ""; // To store the current petId for editing
                let selectedShelterId = ""; // To store the shelterId for updating
        
                // Add click event listener to dynamically created Edit buttons
                $(document).on("click", ".edit-pet-btn", function () {
                    // Get pet data from the row
                    const petRow = $(this).closest("tr");
                    const petId = petRow.find("td").eq(0).text().trim(); // petId (first column)
        
                    // Fetch the full pet data using the petId
                    $.ajax({
                        url: `https://localhost:7063/api/Pet/id?PetId=${petId}`, // Get pet data using the API
                        method: "GET",
                        success: function (response) {
                            // Populate modal fields with response data
                            selectedPetId = response.petId; // Store the selected petId
                            selectedShelterId = response.shelterId; // Store the shelterId
        
                            $("#editShelterId").val(selectedShelterId); // Populate shelterId field
                            $("#editShelterName").val(response.shelterName); // Populate shelterName field
                            $("#editDescription").val(response.description); // Populate description field
                            $("#editStatus").val(response.status); // Populate status field
        
                            // Show the modal
                            $("#editPetModal").modal("show");
                        },
                        error: function (error) {
                            console.error("Error fetching pet details:", error);
                            alert("Failed to fetch pet details. Please try again.");
                        }
                    });
                });
        
                // Save changes on button click
                $("#savePetChanges").click(function () {
                    const updatedPet = {
    petId: selectedPetId, // Make sure petId is included in the body
    shelterId: selectedShelterId, // Shelter ID should be included
    shelterName: $("#editShelterName").val(),
    description: $("#editDescription").val(),
    status: parseInt($("#editStatus").val()),
};

$.ajax({
    url: `https://localhost:7063/api/Pet`, // Ensure correct URL endpoint
    method: "PUT",
    contentType: "application/json",
    data: JSON.stringify(updatedPet), // Send the updated pet details as JSON
    success: function (response) {
        alert("Pet updated successfully!");
        $("#editPetModal").modal("hide");

        // Update the corresponding row in the table
        const petRow = $(`td:contains(${selectedPetId})`).closest("tr");
        petRow.find("td").eq(1).text(updatedPet.shelterName); // Update shelterName column
        petRow.find("td").eq(3).text(updatedPet.description); // Update description column
        petRow.find("td").eq(4).text(updatedPet.status === 1 ? "Active" : "Inactive"); // Update status column
    },
    error: function (error) {
        console.error("Error updating pet:", error);
        alert("Failed to update pet. Please try again.");
    },
});

        
                    // AJAX PUT request to update pet details
                    $.ajax({
    url: `https://localhost:7063/api/Pet?id=${selectedPetId}`, // Make sure 'petId' is part of the query string
    method: "PUT",
    contentType: "application/json",
    data: JSON.stringify(updatedPet), // Send the updated pet details as JSON
    success: function (response) {
        alert("Pet updated successfully!");
        $("#editPetModal").modal("hide");

        // Update the corresponding row in the table
        const petRow = $(`td:contains(${selectedPetId})`).closest("tr");
        petRow.find("td").eq(1).text(updatedPet.shelterName); // Update shelterName column
        petRow.find("td").eq(3).text(updatedPet.description); // Update description column
        petRow.find("td").eq(4).text(updatedPet.status === 1 ? "Active" : "Inactive"); // Update status column
    },
    error: function (error) {
        console.error("Error updating pet:", error);
        alert("Failed to update pet. Please try again.");
    },
});

                });
            });
        </script>
        
   <!-- LOG OUT -->

   <script>
    // Attach an event listener to the "Yes Confirm" button
    $(document).ready(function () {
      // Handle logout button click
      $(".logout-btn").on("click", function (event) {
        event.preventDefault();

        // Clear session storage
        sessionStorage.removeItem("token");
        sessionStorage.removeItem("userId");
        sessionStorage.removeItem("role");

        // Optionally clear cookies or localStorage if used
        localStorage.clear(); // Uncomment if localStorage is also used

        // Notify the user and redirect to the login page
        Swal.fire({
          icon: "success",
          title: "Logged Out",
          text: "You have successfully logged out!",
          showConfirmButton: false,
          timer: 1500,
        }).then(() => {
          window.location.href = "login.html"; // Redirect to login page
        });
      });
    });
  </script>

</body>
 </html>